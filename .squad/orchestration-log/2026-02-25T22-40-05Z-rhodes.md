# Orchestration: Rhodes ‚Äî ONNX-First Architecture Decision
**Agent:** Rhodes (Lead/Architect üèóÔ∏è)  
**Date:** 2026-02-25T22:40:05Z  
**Session:** onnx-architecture-decision  
**Output:** `.squad/decisions/inbox/rhodes-onnx-first-decision.md`  
**Context:** Reviewed Bruce's ONNX model research; supersedes 2025-07-18 Phase 1/Phase 2 decision

## Summary
**Option B APPROVED:** Collapse two-phase plan into single unified pipeline ‚Äî ONNX (YOLOv8-nano) for resistor body localization + HSV math for color band classification. Both from day one. Rationale: 4,422-image dataset exists; YOLOv8‚ÜíONNX pipeline is proven; estimated 1‚Äì1.5 weeks effort is comparable to building throwaway classical CV localization. No wasted Phase 1 work.

## Key Decisions
- **Localization:** ONNX Runtime + YOLOv8-nano (Roboflow fine-tune)
- **Color classification:** HSV math only (never ML-ify color reading)
- **Pipeline:** ONNX detect ‚Üí crop ‚Üí HSV classify ‚Üí ResistorReading[]
- **Dependencies:** SkiaSharp v3.* + Microsoft.ML.OnnxRuntime v1.* (both required from start)
- **Binary impact:** ~17MB (ONNX Runtime ~15MB + model ~6MB)
- **Input resolution:** 640px default, 320px fallback based on device profiling

## Hard Gates
1. **Dataset license gate (Bruce):** Verify Roboflow isha-74mjj license before training. CC-BY 4.0 acceptable; CC-BY-NC unacceptable.
2. **ONNX build spike (Hope):** Validate native lib resolution in MAUI head project before integration starts.
3. **Lighting UX mandatory:** HSV is still lighting-sensitive ‚Äî brightness indicator/"move to better light" prompt required (Shuri).
4. **Camera frame contract:** BGRA8888 formalized (Shuri + Bruce collaboration).

## Sprint Ordering (Revised)
Tasks 1, 2, 4 parallelizable. Task 9 (lighting UX) can run alongside 5‚Äì7.

| Order | Task | Owner | Blocker |
|---|---|---|---|
| 1 | Verify dataset license | Bruce | ‚Äî |
| 2 | ONNX native lib spike | Hope | ‚Äî |
| 3 | Train + export ONNX model | Bruce | #1 ‚úì |
| 4 | Camera frame pipeline (BGRA8888) | Shuri | ‚Äî |
| 5 | ONNX inference wrapper | Bruce | #2 ‚úì, #3 ‚úì |
| 6 | HSV color classifier | Bruce | #4 ‚úì |
| 7 | Compose full pipeline | Bruce | #5 + #6 |
| 8 | AR overlay rendering | Shuri | #7 |
| 9 | Lighting UX guidance | Shuri | #4 |

## Status
APPROVED ‚Äî supersedes 2025-07-18 decision. Ready for implementation. License gate is blocking item #1.

---
**Decision file:** `.squad/decisions/inbox/rhodes-onnx-first-decision.md`
